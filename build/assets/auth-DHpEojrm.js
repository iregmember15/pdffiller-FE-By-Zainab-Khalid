import{a as o}from"./index-D52ZZyUb.js";import{f as n}from"./index-lzhdkBta.js";const u=(r,e)=>{n.set("access_token",r,{expires:1}),n.set("refresh_token",e,{expires:7})},p=async r=>{var e,t;try{const{data:s}=await o.post("/api/auth/login/",r);if(s.status==="success"&&s.jwt){const{access:a,refresh:c,user:i}=s.jwt;return u(a,c),{success:!0,user:i,message:""}}return{success:!1,message:"Invalid credentials"}}catch(s){return{success:!1,message:((t=(e=s.response)==null?void 0:e.data)==null?void 0:t.detail)||"Login failed"}}},g=async r=>{var e,t;try{const{data:s}=await o.post("/api/auth/register/",r);if(s.access&&s.refresh){const{access:a,refresh:c,user:i}=s;return u(a,c),{success:!0,user:i,message:""}}return{success:!1,message:s==null?void 0:s.detail,user:s.user}}catch(s){return{success:!1,message:((t=(e=s.response)==null?void 0:e.data)==null?void 0:t.detail)||"Registration failed"}}};export{p as l,g as r};
